{% extends "sub/main_column.html" %}
{% load staticfiles %}
{% block title %} Mis Advertencias {% endblock %}
{% block left_column_content %}
    {% include "sub/left-panel-user-profile.html" %}
{% endblock %}

{% block right_column_content %}
    {% csrf_token %}
    <h1>Mis Advertencias</h1>
    <div class="frame frame-light">
    {% for comment in user.getCommentsWithWarning %}
        <div class="panel panel-default" id="comment_{{ comment.id }}">
            <div class="panel-heading" style="padding-top: 1px; padding-bottom: 1px">
                <div>
                    <h4>
                        En
                        {% if comment.oferta %}
                            oferta <span class="text-capitalize">"{{ comment.oferta }}"</span>
                        {% else %}
                            empresa <span class="text-capitalize">"{{ comment.empresa }}"</span>
                        {% endif %}
                    </h4>
                </div>
            </div>
            <div class="panel-body">
                <div id="user-comment">
                    <h4>{{ comment.comentario }}</h4>
                </div>
            </div>
            <div class="panel-footer" style="padding-top: 5px; padding-bottom: 5px">
                <span class="text-info"><strong>Advertencia:</strong> {{ comment.getLastWarning.advertencia }}</span>
                <button id="edit_button_{{ comment.id }}" data-idcomment="{{ comment.id }}" type="button" data-text="Editar" class="btn btn-info btn-sm pull-right editButton">Editar</button>
            </div>
        </div>
    {% empty %}
        <p>
            No tienes comentarios reportados
        </p>
    {% endfor %}
    </div>
{% endblock %}

{% block javascript %}
    <script type="text/javascript">
        function wordLoading(word, idTag) {
            var i = 0;
            function dots() {
                var str = '';
                var j;
                for (j = 0; j <= i; j++) str += '.';
                i = (i + 1)%3;
                return str;
            }
            $(idTag).text(word);
            return setInterval(function () {
                $(idTag).text(word + dots())
            }, 500);
        }

        $('.editButton').on('click', function(event) {
            var button = $(this);
            var id = button.data('idcomment');
            var idInterval = wordLoading('Editando', '#edit_button_' + id);
            setTimeout(function() {
                clearInterval(idInterval);
                button.text(button.data('text'));
            }, 5000);
        })
    </script>
{% endblock %}