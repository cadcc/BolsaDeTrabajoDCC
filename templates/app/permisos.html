{% extends "sub/main_column.html" %}
{% load staticfiles %}
{% load filtros %}

{% block title %} Administrar Permisos {% endblock %}

{% block javascript %}
    <script type="text/javascript">
        // Toggle Panels
        $(document).on('click', '.panel-heading span.clickable', function(e){
            var $this = $(this);
            if(!$this.hasClass('panel-collapsed')) {
                $this.parents('.panel').find('.panel-body').slideUp();
                $this.addClass('panel-collapsed');
                $this.find('i').removeClass('glyphicon-chevron-up').addClass('glyphicon-chevron-down');
            } else {
                $this.parents('.panel').find('.panel-body').slideDown();
                $this.removeClass('panel-collapsed');
                $this.find('i').removeClass('glyphicon-chevron-down').addClass('glyphicon-chevron-up');
            }
        })
    </script>
{% endblock %}

{% block left_column_content %}
    {% include "sub/left-panel-user-profile.html" %}
    <hr>
{% endblock %}

{% block right_column_content %}
    <h2 class="text-center"> Administrar Permisos </h2>
    <hr><br>

    <!-- Publicadores -->
    <div class="panel panel-info">
        <div class="panel-heading">
            <h2 class="panel-title"><strong>Publicadores</strong></h2>
            <span style="margin-top: -20px;	font-size: 15px;" class="pull-right clickable"><i class="glyphicon glyphicon-chevron-up"></i></span>
        </div>
        <div class="panel-body">
            <p class="text-info  text-justify">
                Encargados de revisar las ofertas recibidas. Pueden cambiar el estado las ofertas a <strong>Publicadas</strong>, haciéndolas visibles para el
                resto de los usuarios, o <strong>Rechazadas</strong>, eliminando la oferta del sistema.
            </p>
            <hr>
            <table class="table table-hover table-striped text-info">
                <thead>
                    <tr>
                        <th>Usuario</th>
                        <th>Correo</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    {% for p in publicadores %}
                        <tr>
                            <td>{{ p.first_name }} {{ p.last_name }}</td>
                            <td>{{ p.email }}</td>
                            <td class="text-center"><a href="#"><i style="color:#F71D00"class="glyphicon glyphicon-remove"></i></a></td>
                        </tr>
                        {% endfor %}
                </tbody>
            </table>
            <form action="" method="post" class="">
                {% csrf_token %}
                <div class="form-group">
                    <div class="col-sm-offset-1 col-sm-8">
                        <select class="form-control selectpicker" name="publicador" title="Añadir Publicador"
                                data-show-subtext="true" data-live-search="true" data-hide-disabled="true" data-size="5">
                            {% for u in not_publicadores %}
                                <option value="{{ u.id }}" data-subtext="{{ u.email }}">{{ u.first_name }} {{ u.last_name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <button class="btn btn-success col-sm-2" name="add_pub" type="submit">Agregar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Validadores de Práctica -->
    <div class="panel panel-success">
        <div class="panel-heading">
            <h2 class="panel-title"><strong>Validadores</strong></h2>
            <span style="margin-top: -20px;	font-size: 15px;" class="pull-right clickable"><i class="glyphicon glyphicon-chevron-up"></i></span>
        </div>
        <div class="panel-body">
            <p class="text-success text-justify">
                Encargados de revisar las ofertas de Práctica. Pueden clasificar las ofertas de práctica recibidas (y previamente publicadas
                por un Publicador) como <strong>Práctica 1</strong>, <strong>Práctica 2</strong>, <strong>Práctica 1 y 2</strong> o <strong>No Válida</strong>.
            </p>
            <hr>
            <table class="table table-hover table-striped text-success">
                <thead>
                    <tr>
                        <th>Usuario</th>
                        <th>Correo</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    {% for p in validadores %}
                    <tr>
                        <td>{{ p.first_name }} {{ p.last_name }}</td>
                        <td>{{ p.email }}</td>
                        <td class="text-center"><a href="#"><i style="color:#F71D00"class="glyphicon glyphicon-remove"></i></a></td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>

            <form action="" method="post" class="">
                {% csrf_token %}
                <div class="form-group">
                    <div class="col-sm-offset-1 col-sm-8">
                        <select class="form-control selectpicker" name="validador" title="Añadir Validador"
                                data-show-subtext="true" data-live-search="true" data-hide-disabled="true" data-size="5">
                            {% for u in not_validadores %}
                                <option value="{{ u.id }}" data-subtext="{{ u.email }}">{{ u.first_name }} {{ u.last_name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                     <button class="btn btn-success col-sm-2" name="add_val" type="submit">Agregar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Moderadores -->
    <div class="panel panel-warning">
        <div class="panel-heading">
            <h2 class="panel-title"><strong>Moderadores</strong></h2>
            <span style="margin-top: -20px;	font-size: 15px;" class="pull-right clickable"><i class="glyphicon glyphicon-chevron-up"></i></span>
        </div>
        <div class="panel-body">
            <p class="text-warning text-justify">
                Encargados de supervisar las secciones de comentarios. Pueden <strong>ocultar</strong> y <strong>eliminar</strong> comentarios ofensivos, dando la oportunidad
                al autor de editar el contenido para que pueda volver a ser visible de ser aceptada la modificación.
            </p>
            <hr>
            <table class="table table-hover table-striped text-warning">
                <thead>
                    <tr>
                        <th>Usuario</th>
                        <th>Correo</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    {% for p in moderadores %}
                    <tr>
                        <td>{{ p.first_name }} {{ p.last_name }}</td>
                        <td>{{ p.email }}</td>
                        <td class="text-center"><a href="#"><i style="color:#F71D00"class="glyphicon glyphicon-remove"></i></a></td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>

            <form action="" method="post" class="">
                {% csrf_token %}
                <div class="form-group">
                    <div class="col-sm-offset-1 col-sm-8">
                        <select class="form-control selectpicker" name="moderador" title="Añadir Moderador"
                                data-show-subtext="true" data-live-search="true" data-hide-disabled="true" data-size="5">
                            {% for u in not_moderadores %}
                                <option value="{{ u.id }}" data-subtext="{{ u.email }}">{{ u.first_name }} {{ u.last_name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <button class="btn btn-success col-sm-2" name="add_mod" type="submit">Agregar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Administradores -->
    <div class="panel panel-danger">
        <div class="panel-heading">
            <h2 class="panel-title"><strong>Administradores</strong></h2>
            <span style="margin-top: -20px;	font-size: 15px;" class="pull-right clickable"><i class="glyphicon glyphicon-chevron-up"></i></span>
        </div>
        <div class="panel-body">
            <p class="text-danger text-justify">
                Encargados de manejar permisos y cuentas de usuario y empresa. Pueden otorgar o quitar permisos a otros usuarios mediante la asignación
                de Roles (<strong>Publicador</strong>, <strong>Verificador</strong>, <strong>Moderador</strong>, <strong>Administrador</strong>). Tienen
                acceso a las solicitudes de registro de usuarios y empresas, encargándose de verificar la información entregada para aceptar o eliminar
                cada solicitud.
            </p>
            <hr>
            <table class="table table-hover table-striped text-danger">
                    <thead>
                        <tr>
                            <th>Usuario</th>
                            <th>Correo</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for p in administradores %}
                        <tr>
                            <td>{{ p.first_name }} {{ p.last_name }}</td>
                            <td>{{ p.email }}</td>
                            <td class="text-center">
                                {% ifequal p.id user.id %}
                                    <i style="color:rgb(88, 88, 88)" class="glyphicon glyphicon-remove"></i>
                                {% else %}
                                    <a href="#"><i style="color:#F71D00" class="glyphicon glyphicon-remove"></i></a>
                                {% endifequal %}
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>

            <form action="" method="post" class="">
                {% csrf_token %}
                <div class="form-group">
                    <div class="col-sm-offset-1 col-sm-8">
                        <select class="form-control selectpicker" name="administrador"  title="Añadir Administrador"
                                data-show-subtext="true" data-live-search="true" data-hide-disabled="true" data-size="5">
                            {% for u in not_administradores %}
                                <option value="{{ u.id }}" data-subtext="{{ u.email }}">{{ u.first_name }} {{ u.last_name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <button class="btn btn-success col-sm-2" name="add_admin" type="submit">Agregar</button>
                </div>
            </form>
        </div>
    </div>

{% endblock %}
